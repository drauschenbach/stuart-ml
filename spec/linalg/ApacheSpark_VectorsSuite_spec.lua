local moses = require 'moses'
moses.range = require 'stuart-ml.util.mosesPatchedRange'
local registerAsserts = require 'registerAsserts'
local Vectors = require 'stuart-ml.linalg.Vectors'

registerAsserts(assert)

describe('Apache Spark MLlib VectorsSuite', function()
  local arr = {0.1, 0.0, 0.3, 0.4}
  local n = 4
  local indices = {0, 2, 3}
  local values = {0.1, 0.3, 0.4}

  it('dense vector construction with varargs', function()
    local vec = Vectors.dense(arr)
    assert.equal(#arr, vec:size())
    assert.same(arr, vec.values)
  end)

--  it('dense vector construction from a double array', function()
--   val vec = Vectors.dense(arr).asInstanceOf[DenseVector]
--    assert(vec.size === arr.length)
--    assert(vec.values.eq(arr))
--  end)

  it('sparse vector construction', function()
    local vec = Vectors.sparse(n, indices, values)
    assert.equal(n, vec:size())
    assert.same(indices, vec.indices)
    assert.same(values, vec.values)
  end)

  it('sparse vector construction with unordered elements', function()
    local vec = Vectors.sparse(n, moses.reverse(moses.zip(indices, values)))
    assert.equal(n, vec:size())
    assert.same(indices, vec.indices)
    assert.same(values, vec.values)
  end)

  it('sparse vector construction with mismatched indices/values array', function()
    assert.error(function() Vectors.sparse(4, {1,2,3}, {3.0,5.0,7.0,9.0}) end)
    assert.error(function() Vectors.sparse(4, {1,2,3}, {3.0,5.0}) end)
  end)

  it('sparse vector construction with too many indices vs size', function()
    assert.error(function() Vectors.sparse(3, {1,2,3,4}, {3.0,5.0,7.0,9.0}) end)
  end)

  it('dense to array', function()
    local vec = Vectors.dense(arr)
    assert.same(arr, vec:toArray())
  end)

  it('dense argmax', function()
    local vec = Vectors.dense({})
    assert.equal(-1, vec:argmax())

    local vec2 = Vectors.dense(arr)
    assert.equal(4, vec2:argmax()) -- 3 in Scala, 4 in Lua and its 1-based indexes

    local vec3 = Vectors.dense({-1.0, 0.0, -2.0, 1.0})
    assert.equal(4, vec3:argmax()) -- 3 in Scala, 4 in Lua and its 1-based indexes
  end)

  it('sparse to array', function()
    local vec = Vectors.sparse(n, indices, values)
    assert.same(arr, vec:toArray())
  end)

  it('sparse argmax', function()
    local vec = Vectors.sparse(0, {}, {})
    assert.equal(-1, vec:argmax())

    local vec2 = Vectors.sparse(n, indices, values)
    assert.equal(3, vec2:argmax())

    local vec3 = Vectors.sparse(5, {2,3,4}, {1.0,0.0,-.7})
    assert.equal(2, vec3:argmax())

    -- check for case that sparse vector is created with
    -- only negative values {0.0, 0.0,-1.0, -0.7, 0.0}
    local vec4 = Vectors.sparse(5, {2,3}, {-1.0,-.7})
    assert.equal(0, vec4:argmax())

    local vec5 = Vectors.sparse(11, {0,3,10}, {-1.0,-.7,0.0})
    assert.equal(1, vec5:argmax())

    local vec6 = Vectors.sparse(11, {0,1,2}, {-1.0,-.7,0.0})
    assert.equal(2, vec6:argmax())

    local vec7 = Vectors.sparse(5, {0,1,3}, {-1.0,0.0,-.7})
    assert.equal(1, vec7:argmax())

    local vec8 = Vectors.sparse(5, {1,2}, {0.0,-1.0})
    assert.equal(0, vec8:argmax())

    -- Check for case when sparse vector is non-empty but the values are empty
    local vec9 = Vectors.sparse(100, {}, {})
    assert.equal(0, vec9:argmax())

    local vec10 = Vectors.sparse(1, {}, {})
    assert.equal(0, vec10:argmax())
  end)

  it('vector equals', function()
    local dv1 = Vectors.dense(moses.clone(arr))
    local dv2 = Vectors.dense(moses.clone(arr))
    local sv1 = Vectors.sparse(n, moses.clone(indices), moses.clone(values))
    local sv2 = Vectors.sparse(n, moses.clone(indices), moses.clone(values))

    local vectors = {dv1, dv2, sv1, sv2}

    assert.equal(dv1, dv2)
    assert.equal(sv1, sv2)
    
    local another = Vectors.dense(0.1, 0.2, 0.3, 0.4)

    for _,vector in ipairs(vectors) do
      assert.not_equal(vector, another)
    end

  end)

  it('vectors equals with explicit 0', function()
    local dv1 = Vectors.dense({0, 0.9, 0, 0.8, 0})
    local sv1 = Vectors.sparse(5, {1, 3}, {0.9, 0.8})
    local sv2 = Vectors.sparse(5, {0, 1, 2, 3, 4}, {0, 0.9, 0, 0.8, 0})

    local vectors = {dv1, sv1, sv2}
    for i=1,#vectors do
      assert.equal(vectors[i], vectors[i])
    end

    local another = Vectors.sparse(5, {0, 1, 3}, {0, 0.9, 0.2})
    for i,vector in ipairs(vectors) do
      assert.not_equal(vector, another)
    end
  end)

  it('indexing dense vectors', function()
    local vec = Vectors.dense(1.0, 2.0, 3.0, 4.0)
    assert.equal(1.0, vec[1])
    assert.equal(4.0, vec[4])
  end)

  it('indexing sparse vectors', function()
    local vec = Vectors.sparse(7, {0,2,4,6}, {1.0,2.0,3.0,4.0})
    assert.equal(1.0, vec[0])
    assert.equal(0.0, vec[1])
    assert.equal(2.0, vec[2])
    assert.equal(0.0, vec[3])
    assert.equal(4.0, vec[6])
    
    local vec2 = Vectors.sparse(8, {0,2,4,6}, {1.0,2.0,3.0,4.0})
    assert.equal(4.0, vec2[6])
    assert.equal(0.0, vec2[7])
  end)

--  it('parse vectors', function()
--    val vectors = Seq(
--      Vectors.dense(Array.empty[Double]),
--      Vectors.dense(1.0),
--      Vectors.dense(1.0E6, 0.0, -2.0e-7),
--      Vectors.sparse(0, Array.empty[Int], Array.empty[Double]),
--      Vectors.sparse(1, Array(0), Array(1.0)),
--      Vectors.sparse(3, Array(0, 2), Array(1.0, -2.0)))
--    vectors.foreach { v =>
--      val v1 = Vectors.parse(v.toString)
--      assert(v.getClass === v1.getClass)
--      assert(v === v1)
--    }
--
--    val malformatted = Seq("1", "[1,,]", "[1,2b]", "(1,[1,2])", "([1],[2.0,1.0])")
--    malformatted.foreach { s =>
--      intercept[SparkException] {
--        Vectors.parse(s)
--        logInfo(s"Didn't detect malformatted string $s.")
--      }
--    }
--  end)

  it('zeros', function()
    assert.same(Vectors.dense(0.0, 0.0, 0.0), Vectors.zeros(3))
  end)

  it('Vector.copy', function()
    local sv = Vectors.sparse(4, {0, 2}, {1.0, 2.0})
    local svCopy = sv:copy()
    assert.equal(sv:size(), svCopy:size())
    assert.same(sv.indices, svCopy.indices)
    assert.same(sv.values, svCopy.values)
    assert.not_equal(sv.indices, svCopy.indices)
    assert.not_equal(sv.values, svCopy.values)

    local dv = Vectors.dense(1.0, 0.0, 2.0)
    local dvCopy = dv:copy()
    assert.equal(dv:size(), dvCopy:size())
    assert.same(dv.values, dvCopy.values)
    assert.not_equal(dv.values, dvCopy.values)
  end)

--  it('VectorUDT', function()
--    val dv0 = Vectors.dense(Array.empty[Double])
--    val dv1 = Vectors.dense(1.0, 2.0)
--    val sv0 = Vectors.sparse(2, Array.empty, Array.empty)
--    val sv1 = Vectors.sparse(2, Array(1), Array(2.0))
--    val udt = new VectorUDT()
--    for (v <- Seq(dv0, dv1, sv0, sv1)) {
--      assert(v === udt.deserialize(udt.serialize(v)))
--    }
--    assert(udt.typeName == "vector")
--    assert(udt.simpleString == "vector")
--  end)

--  it('fromBreeze', function()
--    val x = BDM.zeros[Double](10, 10)
--    val v = Vectors.fromBreeze(x(::, 0))
--    assert(v.size === x.rows)
--  end)

  it('sqdist', function()
  
    -- Test parameters generated by VectorsSuite.scala, which has better random number support
    local testData = {
      {
        m=1,
        nnz=0,
        indices1={},
        values1={},
        indices2={},
        values2={},
        breezeSquaredDistance=0.0,
        sqDist=0.0
      },
      {
        m=101,
        nnz=15,
        indices1={6,18,25,28,31,39,45,54,70,74,76,79,88,89,96},
        values1={0.6549898025565702,0.15630925289633946,0.014903305949574452,0.4865533843491089,0.17588299632500715,0.4582467919157195,0.7704830888880749,0.49098098803567003,0.2191117298379781,0.13955238932983394,0.14944976901124785,0.8193503010363743,0.8891741264537395,0.9824350904570935,0.8923566139898045},
        indices2={19,20,35,36,39,40,46,54,60,73,78,85,87,91,96},
        values2={0.4811728641878009,0.8378658139983693,0.3645603946872179,0.08060554956339994,0.33066528611796275,0.7488823807959284,0.9982401457660727,0.03919248736655356,0.4271131348325923,0.6878546308818715,0.47052932733010855,0.29508223591284377,0.4960370484960597,0.6644650973727678,0.7657648686181338},
        breezeSquaredDistance=8.35022301834667,
        sqDist=8.35022301834667
      },
      {
        m=201,
        nnz=37,
        indices1={2,4,9,11,15,21,31,34,37,38,43,54,61,62,65,66,69,71,78,81,82,98,103,106,114,119,122,133,136,157,167,170,179,181,186,193,195},
        values1={0.3820141363380041,0.7413916947772609,0.12735880836300206,0.4867818860452976,0.7395526902381002,0.4120201280679783,0.940820941321757,0.9088075632647837,0.6520523833912427,0.34723800472150945,0.08917514514252955,0.3371217629992552,0.2832363420965929,0.3788577190580207,0.7150189060714163,0.474678427711707,0.8124515294644999,0.30242320624220886,0.5538073590072302,0.03484797517648952,0.8956884535389087,0.4321172778467044,0.19912784150698137,0.6359226852326856,0.960002410598504,0.17114610412145093,0.6146606755507394,0.11376341420149028,0.8446728355091073,0.6385247225641444,0.9554782853403867,0.22173461874884415,0.5651317663249416,0.47619594360269524,0.977155981241395,0.8482067393623846,0.3946385797606803},
        indices2={2,4,8,14,18,25,34,35,39,40,41,43,49,67,83,88,89,94,95,106,107,111,114,116,118,122,127,138,143,144,145,153,169,179,191,194,196},
        values2={0.4709330705147119,0.795440718779379,0.6174587677111701,0.3721208958937978,0.7303172798802509,0.8824105952737094,0.7121637413070583,0.1848946746416904,0.4316744864419917,0.51849500176792,0.057701246845435095,0.9895570618696834,0.6587484525633412,0.11474747155235598,0.25720558552352424,0.754520367772983,0.9685197336989706,0.3811522681496696,0.4840531001667161,0.735379909547788,0.3994914954476273,0.8460741707778943,0.7532389354840999,0.13084099182481024,0.4542539067031477,0.8277777042449919,0.9573913427452572,0.49877457886698984,0.8257666195814549,0.41480870839577966,0.5213365147369612,0.6088243806383672,0.5323070036723998,0.540352052073712,0.5027587901107214,0.13943212414297068,0.42778921816926974},
        breezeSquaredDistance=19.927885635116443,
        sqDist=19.927885635116443
      },
      {
        m=301,
        nnz=10,
        indices1={12,34,40,200,214,226,243,259,270,295},
        values1={0.10010112596268084,0.410348147582814,0.742382480812988,0.15578052086824556,0.25378442593560047,0.1798596841114698,0.9405296811390346,0.2893165534237495,0.14414018717867927,0.8510974694344097},
        indices2={22,25,31,42,60,109,133,223,230,291},
        values2={0.3024916415050234,0.8405034969681386,0.4126675366212379,0.7566558349211239,0.6502057989403774,0.34539248580934534,0.4483404171977461,0.8027863501482376,0.6963336603934104,0.09665122083124611},
        breezeSquaredDistance=5.986535141074847,
        sqDist=5.986535141074847
      },
      {
        m=401,
        nnz=269,
        indices1={0,1,2,3,4,6,7,9,10,13,14,15,16,18,19,20,21,22,23,25,26,27,28,29,31,32,33,34,35,36,38,39,40,42,43,46,47,49,50,51,53,56,57,58,62,63,64,65,67,69,70,71,74,75,77,78,79,80,81,82,83,84,85,86,88,90,92,93,94,97,100,101,102,103,104,105,106,109,110,111,112,113,114,115,116,118,120,121,122,126,129,130,133,134,135,137,138,139,140,141,142,143,144,146,147,150,151,153,156,157,158,159,161,164,165,166,167,168,169,170,171,172,173,174,175,179,180,181,183,184,186,187,188,191,192,193,195,196,197,198,199,201,202,204,207,209,210,211,213,214,215,216,217,218,219,220,221,223,224,225,227,229,230,231,232,233,234,235,238,239,240,241,243,244,246,248,249,250,253,254,255,256,258,259,261,262,263,264,266,267,269,270,271,275,278,279,282,283,284,288,290,291,292,295,296,297,298,299,301,306,307,308,309,310,311,313,314,315,317,318,319,320,321,322,323,324,326,328,329,332,334,335,336,339,341,347,349,350,351,352,354,358,359,362,363,364,365,366,367,368,370,371,372,373,374,378,381,382,383,384,385,386,387,389,390,391,393,394,395},
        values1={0.3869685198237909,0.2725621195591684,0.5016015353238632,0.5628313240606954,0.9818705438050482,0.532695909810095,0.6343086109169866,0.82009552741105,0.288720493977241,0.34549766265039505,0.07177086317352754,0.1727359964281977,0.08627010263358204,0.022223789488126533,0.8884200253182217,0.3166302853001304,0.6977821305200429,0.40038818648886254,0.08608983149207394,0.8472163538485163,0.9448782168721162,0.2856378727157668,0.13000818654361845,0.11582220538215748,0.2033963865441869,0.7496742771894872,0.8466408494960962,0.42075501162303397,0.593881749854374,0.22529090750708503,0.6364203981824348,0.367287282230929,0.2817162399024007,0.7897930066372526,0.7249013619176476,0.6339967190393035,0.7105265512720907,0.634510781638698,0.35264115687351183,0.442487616484056,0.34739182115132927,0.4808121861207717,0.3871130650393745,0.7433418708118972,0.1795056383162058,0.6219675739542277,0.8292165220509886,0.5032174971473657,0.7693298575686842,0.345412881138887,0.08245671297945789,0.5063333366792115,0.14891019866996036,0.7214042101458207,0.6546243142372322,0.7681488461795248,0.21390677755710197,0.13175115059115905,0.1698130662583045,0.9998679905309209,0.5640251231571533,0.45626223942919075,0.18287135142865618,0.5594667529431231,0.9289166486588069,0.5347305882360014,0.30889161128781606,0.978264190055607,0.41724966198700864,0.37873377541678466,0.6070989517465557,0.4616267239034254,0.831535230438592,0.620216607275572,0.991508370224982,0.7282166106349997,0.2024251135645848,0.8527711399572739,0.6799780683608279,0.17426472533832305,0.5135813676132781,0.8467239788959512,0.3387935134092116,0.6276692746924234,0.3118504154796602,0.10058503717913181,0.6316751730999948,0.8912912346587549,0.5273571015427114,0.8291087965897169,0.3401107867291442,0.865638560201496,0.36426689844251336,0.2821629678698562,0.08617017279901096,0.2882008474897104,0.5653474795913009,0.23879593750519046,0.9594693692808082,0.030016977408608536,0.7020935719684344,0.6273387635826608,0.026707661062789323,0.4496281569221835,0.39706165654199377,0.4850735428267532,0.785209763880932,0.5203892367049131,0.5461942547334461,0.8899447047330337,0.1111626926393775,0.3191816979553489,0.676296140911818,0.07198559588108666,0.14874482008501844,0.9928917021751514,0.5464574490164974,0.6435774373531139,0.8881024352347843,0.5035869343096528,0.9821019070107624,0.7753538890057382,0.8881371569978586,0.29414673140730874,0.7164707713395065,0.18850877278667544,0.7143247146000345,0.5131694771330578,0.7067362330437029,0.03446068884286402,0.18229437609873844,0.5913026608143008,0.9905705928513553,0.08927297987344018,0.42465506849277146,0.7707099523653919,0.6538805763152131,0.20292321973119698,0.13156308549985718,0.6552113468336087,0.8915485600061832,0.6124613633328646,0.05478315398063249,0.9707017286347823,0.46040596423515656,0.5532913270131559,0.01050313331078867,0.5037739402996849,0.047296073765174196,0.5842557900501879,0.16792007153465283,0.6210427361866095,0.20496696631573963,0.17989956659001327,0.3686232577920203,0.8624863647707894,0.544667973189093,0.4372320985359176,0.5860577260514057,0.8491924769602517,0.8167054203841192,0.1945048664752016,0.4048594551128548,0.1492159137125576,0.35884682202572826,0.4659649266016681,0.5766114529760049,0.8048258064913447,0.1473453730820128,0.8592411482397059,0.2915772798472881,0.9402398934275762,0.34648878338917777,0.560964870171789,0.7952272308303567,0.24101441639147436,0.8199604302281491,0.5514220764513639,0.3738791778574727,0.12457779368849464,0.5409325481903609,0.9404796349335675,0.5355346710658827,0.1059674416208316,0.21769455243191382,0.7047231824409926,0.41999846157915166,0.2036481737342668,0.7377525184825279,0.649689981986732,0.08662708419335807,0.22736242677955387,0.22571790131595781,0.1212746571570299,0.34856078148951386,0.4432814550144105,0.6089375102154775,0.8468321068433018,0.24904979075734757,0.421297874467605,0.5896985854716104,0.299195977485224,0.10849469632127318,0.8351199797042311,0.8339760797047033,0.1457774839065057,0.3100780431631063,0.6078984832790499,0.004072082868219584,0.6701038321584154,0.6373721436493596,0.07443651892531555,0.986129954376018,0.5346014507013671,0.02906576417633222,0.7656046933613447,0.2933888535641307,0.8911241763568143,0.07396068908550679,0.011402388528570007,0.16217659013548935,0.6396718545583215,0.4336462222344777,0.8061774608409851,0.3000222696177177,0.585940290905753,0.6507681694426083,0.2828367065513925,0.5939023880793012,0.3547889391649147,0.4775661697649709,0.7024495288688472,0.3415173089909519,0.1794073696975098,0.9423614218396122,0.08146768943593374,0.7296274662335042,0.10490778623636932,0.8609343634833818,0.4508546306766207,0.35086179016663244,0.720265473991284,0.3952400493849554,0.26973746896597484,0.5240434966865251,0.26397449717064647,0.5636660748232664,0.7007658402436091,0.06296113816415017,0.8364818317033322,0.31504678874943326,0.2951816324831765,0.9246458092782075,0.49640737778472754,0.8929043679096939,0.13267406638103896,0.8605980637941347,0.2177538062512836,0.7368954228159287,0.6144147373722335,0.7930409518332842,0.04175448236109558,0.09520008850431971,0.9172382262081173,0.14315839270601782,0.2697036844280033,0.8545976174523804,0.5827529055181383,0.749411004960602},
        indices2={0,1,2,4,5,6,7,8,9,10,11,13,16,17,19,20,22,24,25,26,27,28,29,30,32,34,35,38,42,43,44,46,47,48,49,50,51,52,55,57,59,60,61,63,65,67,68,69,74,75,77,78,79,80,81,83,84,86,87,89,91,93,94,95,97,98,99,101,102,103,104,105,106,107,110,112,115,117,118,119,120,122,123,124,125,127,128,134,137,142,144,145,147,148,149,150,151,153,154,155,156,158,159,160,161,162,163,165,167,168,169,172,173,174,175,176,177,178,179,180,184,185,187,189,190,193,195,197,198,199,200,201,204,205,206,208,209,210,211,213,214,215,216,217,218,219,221,225,226,227,230,232,233,234,239,240,241,245,246,247,248,249,250,252,253,254,255,256,257,258,259,260,262,263,264,266,268,269,272,273,274,275,276,278,279,280,282,283,284,287,288,290,291,292,293,294,295,297,298,299,301,303,304,305,306,307,308,310,311,314,315,316,317,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,339,341,342,343,344,346,347,348,349,350,351,352,355,356,358,359,360,361,363,365,368,371,372,374,375,377,378,379,382,384,386,387,389,393,396,398,400},
        values2={0.2590624239746677,0.8396002798696571,0.1472807218150236,0.1923385365866983,0.32351217277672306,0.7608656771910022,0.44763827064611594,0.5089251313251103,0.450004518246236,0.40260326887685727,0.3407135610117382,0.4087527604184954,0.41205055617198805,0.4100211042955749,0.16280622148071355,0.6956197239704492,0.039547568326801175,0.8363406231468207,0.16653492343036136,0.021145715788890906,0.635692268776603,0.1539255462700847,0.6166241953270061,0.09388194655907811,0.6930855214668746,0.6106912425182066,0.058616074812635977,0.733534188448203,0.8354504502560278,0.8467424366851589,0.09562042218663769,0.847843703187086,0.642831819205792,0.9879442712603976,0.1927873849318047,0.28955405776006093,0.9058390428299141,0.1411399447385484,0.8700066521252844,0.33702479615426695,0.8984410690685263,0.3299861100408714,0.14040744693885399,0.23443546454639963,0.45901642682220944,0.4308843769608629,0.20555434065454836,0.8261561470826152,0.025807211545797903,0.5952458576047011,0.22780396737011877,0.8247443392042705,0.28562084730113235,0.9773328774362235,0.46610787124512476,0.6631595807481231,0.7635691250792389,0.3261802352496671,0.18361735556816705,0.19917109824011558,0.5068289936259324,0.14560594504215552,0.5137663416322547,0.7635659204073276,0.9968550625334958,0.6780792595220105,0.9060784367314941,0.17364803634817738,0.562169067640323,0.9262216161416857,0.8637650866718967,0.3696519699336078,0.8577969587345766,0.28997406639359957,0.43225153771991054,0.27407654255365654,0.42761930744873033,0.16797222611273877,0.30108806952785994,0.32257827310571086,0.9723462484254868,0.04842804058683026,0.4412740494561881,0.8699455110850995,0.7085236377913685,0.19782511386005786,0.9158425449163291,0.3358084563315076,0.12292195854697596,0.04499234783422701,0.8736239907223309,0.5221219935402395,0.5018552723932574,0.7536284732673885,0.764427148539764,0.008091620466361804,0.8464226918427001,0.2781075080268054,0.49844647602535785,0.9080956045708033,0.17235985734680637,0.40540370828456784,0.6135247195790607,0.5642888934829173,0.7371337350831975,0.9002316823550672,0.5109705899792235,0.9379576307929645,0.43710909266178555,0.8910053689473908,0.47395098802421176,0.5623255425964625,0.47406012659702046,0.06097770727746099,0.492047921055052,0.9243964371053365,0.4029964433940536,0.04193012188244216,0.8813906944826727,0.054549884262547255,0.8422175795050962,0.6470392280452146,0.31184380266089184,0.9199900232636402,0.4517058402339601,0.22505569103373313,0.13105186446374384,0.9417799659679156,0.26741201339026865,0.4696879273654685,0.8097126410630394,0.585077406850329,0.11668482450359585,0.47609155743946097,0.923270005943846,0.5083197723214934,0.6340390320045532,0.7006227458240009,0.3322886984851039,0.19948976744468772,0.346653432324585,0.7505219887172788,0.12709322788248367,0.3762256536950094,0.4054348820570177,0.6069522626350252,0.4618233905218945,0.6814225885474359,0.8001797588155289,0.9678232541416212,0.6188795046013905,0.36710470756824853,0.31630971659475915,0.8860918709468331,0.5168003246432726,0.726730424969348,0.06585387706040535,0.7747358269394696,0.4029373891704542,0.009725952389548542,0.1567947650751177,0.15135647668650543,0.6568595189046599,0.43192507775250377,0.9525910303552937,0.20337313911546118,0.4712415869774317,0.6817259719524702,0.41763449441191525,0.3690305712393034,0.6740620648922481,0.014158707476130794,0.24459555640788966,0.6499479810053675,0.10925425304079617,0.6236897732417095,0.816054983114251,0.2976962355826086,0.8025260407202502,0.4914730032917842,0.5655166035582135,0.8498977457903986,0.6048837148153695,0.31388864750788936,0.9718398684721251,0.23060100812640905,0.12846558630875127,0.43659584168227594,0.24632706044207198,0.775190035854451,0.5676114467971788,0.9419557998760383,0.7531450814568392,0.5918463750458783,0.4326639542100794,0.16756641072806444,0.34145690072670765,0.6295894363359854,0.31481902102893344,0.9697813956863657,0.061583528124770304,0.1871784055761102,0.5474117702094199,0.9884703009307466,0.1877120290640718,0.3676672335269735,0.032345673548045295,0.01790797513665565,0.07611111845698171,0.16016162633068465,0.5599420545750725,0.34356562033374727,0.15051031417889082,0.413334861118855,0.6663083971431042,0.5657076236545663,0.2252452641703654,0.9545174261461264,0.44439300721607744,0.9980816126381066,0.45196539604806274,0.5036825762764664,0.7532152675159551,0.20362219974644546,0.4071471644763909,0.8334084207900617,0.9543297425441595,0.6089707540970742,0.22535013935307135,0.8339046477287797,0.6454036077414874,0.42574774698062967,0.2270990981807034,0.7564496294508773,0.8578566851028722,0.2988957110298628,0.19047070014156142,0.9290920586685134,0.8388340333984069,0.2010443844012555,0.27190801874790693,0.6652281531170089,0.8473511486592199,0.0967325286190408,0.5944824296792515,0.9186743270244199,0.360271796998587,0.8114529435915823,0.6907666185707072,0.47811224401656593,0.7058500407886378,0.3578711273581142,0.31267893260561774,0.13929130433728043,0.4208864368353682,0.6951996243311134,0.6021032410241391,0.3451313891701949,0.5621205807270557,0.5275943064504217,0.2537854959239434,0.24187656325399087,0.7933012457359473,0.28356988491144963,0.09595163518069938,0.9637081705680178,0.3164461753088028,0.8608168148136321,0.4642883176978748},
        breezeSquaredDistance=87.35285565153163,
        sqDist=87.35285565153163
      },
      {
        m=501,
        nnz=250,
        indices1={3,4,6,7,9,10,11,13,15,17,21,23,24,25,28,29,33,35,39,42,44,45,48,49,51,52,54,56,58,60,61,63,67,69,72,73,74,77,78,81,83,88,89,90,91,93,96,99,102,107,109,114,115,118,119,120,121,122,124,125,128,129,132,135,141,144,145,149,150,153,155,156,157,158,161,163,166,168,170,173,174,183,185,186,192,193,195,196,203,204,205,206,208,209,210,211,213,219,220,222,224,227,228,232,233,235,236,238,240,242,243,250,251,252,254,255,256,257,258,259,262,263,264,266,268,272,273,274,282,283,284,286,288,289,290,292,293,294,296,297,302,303,304,305,309,311,312,313,314,315,316,317,319,321,322,323,324,325,330,334,336,337,339,340,341,343,344,345,346,348,351,352,353,354,356,357,359,361,362,364,368,369,370,371,374,375,376,377,380,381,382,383,385,388,389,390,394,395,397,399,400,402,408,411,414,416,418,420,421,424,425,426,427,431,436,440,443,444,448,450,451,452,453,454,456,457,461,466,467,468,472,473,474,479,481,482,483,484,486,487,488,490,491,492,493,494,496,497,498,499},
        values1={0.8419019536000641,0.8514108829385009,0.04026426503900915,0.7001593992272702,0.5918332974363337,0.7156713310661476,0.4672759764412511,0.6238750320115078,0.9878351036862085,0.3382362241375898,0.9840613409809018,0.3297846084984809,0.6254000114588765,0.919625798401305,0.5173473821490069,0.23743681733463928,0.9885779491690153,0.5463869174575657,0.7449036174769389,0.7691756134194921,0.8448839404009163,0.30772737570131026,0.11371446237781213,0.4674388532243534,0.03365449955967903,0.9532813484301503,0.972319195515291,0.3676808033354525,0.4918779039029534,0.41771997402655403,0.8454254149776944,0.5312458159833919,0.549998805893554,0.8279601625292998,0.8330049745583371,0.32318456794056105,0.4999255564009185,0.9300140186828868,0.35143165782668007,0.23191861371050426,0.18844432772464526,0.2250600458401285,0.9508223759127115,0.7708226716252282,0.9214708594658734,0.48810664767742595,0.7405945291125127,0.2762082940055638,0.278047639972842,0.7576570860643371,0.034354183776781566,0.22185662486790825,0.5277201509241174,0.3310747737483929,0.18558117083267778,0.007162133702351414,0.22090299068525354,0.7778860018717478,0.22717858754985842,0.04411287595124358,0.17907315231835186,0.4920470837743921,0.8508059119276761,0.36774754950677424,0.550103732759978,0.8442414429258722,0.46601681073594703,0.9253930523387994,0.8137789917749407,0.5665613064135712,0.5645732327691975,0.16190048542254076,0.6235069693303084,0.6044679093634354,0.3819105664885294,0.5112619616111198,0.15247359128849902,0.3047130527460725,0.8955785901652331,0.9294041766123785,0.1759577860349949,0.4729439342622376,0.529585479260031,0.6586189479980318,0.4662546370498801,0.5310022552964127,0.5439235496822283,0.0010049977308812519,0.20262911929992622,0.7314674876592081,0.9801567051518809,0.9964594410657996,0.005950504180534555,0.1457838007818405,0.20680125857715403,0.5501711240137181,0.8961335369992981,0.9323482680047767,0.5623334343212004,0.7352325682675391,0.9402390192231848,0.21222824040228172,0.3290084751715996,0.7079006759063873,0.6100633755024054,0.7327135341416124,0.287277636322099,0.9162012134300748,0.9002729309406875,0.3826991953696607,0.39844073185314954,0.056985291584085274,0.07161536791309542,0.5389333746618518,0.7422743799381272,0.5422108324699072,0.47846765239806355,0.1684532595358209,0.6967263781495692,0.07213570128832736,0.31595569341795515,0.590072164588415,0.4883691107356052,0.28127317744347513,0.27910806292318135,0.8065691583778676,0.6651563120290606,0.32237512117201716,0.06498249897168562,0.35927181566189115,0.747128539891543,0.6843711433668299,0.3684303576041643,0.7280120630577006,0.29606516822385387,0.5021072864477635,0.5231411303317394,0.40197362233265055,0.9116813396391558,0.10889116458139003,0.2218350698173388,0.8807393196256604,0.20982057056472192,0.6072646509584985,0.8129492205282224,0.029884674818118406,0.6671949189050783,0.7890892782433467,0.5158880516559159,0.41175414028556845,0.3275763586847126,0.822943803933192,0.5228872825630697,0.43959505272900024,0.7559443478214162,0.744997050745388,0.36276493425619305,0.46201301760218416,0.29994641843142833,0.9389336384972999,0.09031139563095103,0.1747523741214183,0.6721299505558933,0.47117379012211735,0.8347959199466978,0.07809368423984264,0.10175503379673079,0.3595430321280949,0.9920440116355248,0.05069953349914458,0.8215996425938147,0.5967111433902864,0.8767667634931839,0.49452934186039144,0.4530202481421649,0.02413402810993548,0.9652992999301457,0.9204820918641747,0.9316322413424633,0.9578964199188322,0.9536325931992271,0.29071585510931974,0.9763262940900137,0.8047668087930447,0.7315992433211569,0.9111315919240883,0.7459381912700958,0.7749408366373859,0.03130025777197554,0.17629770137342604,0.25074149790189204,0.19736275518465696,0.9463365977890684,0.009131045487600575,0.29003365677867576,0.8741789740241768,0.738135976372675,0.408939394590657,0.17243785927582067,0.37279181662088057,0.34664120463723547,0.12396867989223492,0.24214459538586364,0.14714555672561613,0.8048543428399716,0.09838834515881933,0.28216842181104584,0.9042905372021984,0.32020567066578853,0.008686421463523053,0.19479665265669066,0.6879362128269315,0.13044484310742088,0.9007354048372175,0.9697589852488349,0.7376167019706321,0.3677268082228845,0.6663291208932721,0.8422475734168248,0.30025779663491303,0.07179228698049811,0.8567794684698535,0.7157700288693514,0.22034724008413753,0.1816190966001865,0.12120118480082254,0.378917858929146,0.3155752195647874,0.8046471866346644,0.37840234417133967,0.7804855387138745,0.25672534051567486,0.31365629585432353,0.6838361936817419,0.6439765657312152,0.9137605602567951,0.8536027735724293,0.6368601818477706,3.844068467866446E-4,0.9044631865645228,0.6541975266753013,0.08858649088284287,0.7972377895508386,0.3876508993255865,0.13873433622367604,0.8568974407257101,0.6022514008004006,0.9799064658729568,0.19565414854929053,0.13273846436900372},
        indices2={1,2,3,4,5,7,8,9,10,14,15,18,19,20,21,22,23,25,26,30,31,33,34,36,37,40,43,45,46,47,49,51,53,56,57,59,61,63,66,68,69,73,74,75,76,78,79,81,83,84,87,88,89,90,91,93,94,97,101,102,104,106,107,112,113,120,121,125,126,130,135,137,139,141,144,145,146,147,148,149,150,152,153,155,158,159,162,164,167,168,170,174,175,178,183,187,189,192,193,194,196,197,198,200,203,205,207,211,212,213,216,218,219,220,226,227,229,230,233,234,236,238,241,242,243,244,245,247,248,251,255,258,260,262,264,265,266,267,269,274,276,277,278,279,280,281,282,288,291,298,299,300,301,302,304,306,307,310,313,315,317,320,321,322,323,325,328,330,333,335,340,343,345,346,353,354,356,357,362,364,366,373,374,375,376,377,379,382,383,384,388,389,390,391,393,394,396,399,401,402,403,407,411,415,416,417,418,419,420,424,429,430,435,439,442,444,445,446,447,451,456,457,458,459,460,461,462,465,466,468,469,470,471,473,474,476,477,478,479,481,483,485,487,488,489,493,494,498,499,500},
        values2={0.6480632692066459,0.9228459749884151,0.38558585184904837,0.7633972733188197,0.698049517062032,0.9203182403941312,0.3860313744138507,0.8495091232048062,0.5460299326597904,0.9111013018824362,0.7373890875297049,0.5092270578293281,0.6154211810645894,0.7457042810816111,0.9910068316507863,0.22796144509519511,0.2848873995262483,0.8273250217046144,0.5413428728063124,0.7922849181773749,0.8019369459043919,0.5350840510461768,0.7321176464277074,0.8721100244315324,0.9739099435909739,0.3928879366877116,0.06457840954200333,0.7333991497075433,0.7274509618428402,0.7520188917473208,0.48617855081114925,0.2562419135186508,0.47228891869931666,0.9518364237458395,0.8483254743159301,0.5200493075251926,0.8311219580883553,0.150516544807489,0.013451614361516318,0.8357779403042656,0.7046320158826579,0.2765421057837285,0.7645159504072468,0.25451166167820893,0.8291305465371235,0.8416978049634648,0.6241435902233348,0.26239218091300187,0.9540627023640551,0.6776119707483038,0.9259638952663543,0.583804036692445,0.5175748385929639,0.010426442992912177,0.9973079153290307,0.7578836746228828,0.23057589343190055,0.6719648408646278,0.11027855674589737,0.42783611392287424,0.29320033105942367,0.6608088319120029,0.9373077127961416,0.0882069756990077,0.06230644833669363,0.7129806346653564,0.6076664868683931,0.3721716663379613,0.8646208105840383,0.019469475046764884,0.10299617812548223,0.8290675143756705,0.30736616121932614,0.7366286446307333,0.6527791738535584,0.5418087967486928,0.8766859122728977,0.47550859360259035,0.9947704514110153,0.8644883837533892,0.8339062629090733,0.5274811016849175,0.850762214522345,0.022384522439903964,0.4206521639118411,0.1860480989944131,0.7346552305090761,0.30975420452713087,0.1660609332363343,0.15851810780463538,0.25766254465829874,0.14520984427056716,0.6528133376769366,0.7262722491230257,0.4245725030491835,0.30013901958833056,0.4434285938291571,0.008630587965564485,0.025349637684542237,0.20254178476170903,0.9942466352967636,0.4128691872001733,0.11795351067305704,0.33682395237337504,0.2917469802274918,0.11172685839469987,0.7711073009957063,0.409498361875271,0.6343307446159915,0.17977950584570457,0.6898492712300064,0.1314111265157316,0.4524183087987885,0.841349857234883,0.08205198775369094,0.17902288614503092,0.3106921519617424,0.13515832563205854,0.14069580956821603,0.1404399606540061,0.26854079805920705,0.18471064204032495,0.8145341417278698,0.026303912941348817,0.588236038834873,0.17845684453485344,0.11889059401344704,0.23131223909556053,0.3751028971369573,0.11004462651459657,0.09867854514268581,0.6690569469582123,0.10991766303992556,0.30653001882821007,0.6973360982066779,0.17103200513274974,0.19099613080474753,0.7811969283197193,0.20822032867428342,0.1400742232537645,0.5419109774589765,0.4876760115086092,0.6891069481393046,0.8791668341736012,0.06050327889631135,0.6233429352893819,0.7057922931841555,0.9784487587903371,0.18583030462674754,0.23251441896320457,0.03739686463006542,0.6364363323183176,0.1419177324787636,0.493750379918527,0.5238205227064207,0.815879095662718,0.480661485036078,0.24060875550419958,0.06490167481779385,0.6903344547963348,0.3909505285289183,0.46148909651755976,0.8911837818145146,0.9244607287950027,0.8670588463223489,0.7517401096276581,0.6177944762542985,0.9491917804679533,0.23658124076144782,0.9499949222667784,0.2657936992356522,0.5423706914488212,0.7366640759798291,0.4807377719933259,0.38944954754643557,0.7060838823198609,0.7970089377843711,0.246393715393598,0.6832512531905867,0.043851343477353644,0.43910332240679173,0.2647732497949331,0.9590708432625137,0.5839922356323715,0.7333594979884583,0.631491884652946,0.1817364336671532,0.269899917624314,0.569318778295726,0.8020240263110971,0.33038162979919616,0.14362373669246786,0.08880548489546358,0.6343398876211386,0.21328697708473232,0.5860696378343162,0.007890959406782527,0.11061296621623773,0.00553137559551975,0.8452951917740911,0.7107549692293152,0.16527436927729644,0.20162240035760814,0.4837891511383169,0.43700804449948816,0.5867301501247149,0.8793762661256812,0.306289139832405,0.1037653151706639,0.5313458975715124,0.6566699525206775,0.7916060796299679,0.3047383180975126,0.7908428526830883,0.4892892558915347,0.04508675023528952,0.8108384735211105,0.5880379749044081,0.5059481521319366,0.8127612180297363,0.4602621340155876,0.34090024651803297,0.40565649723302843,0.15388486678394908,0.6707536576764799,0.5311839171388422,0.5529647744843637,0.9554996229368806,0.9327196722913605,0.5414389710379031,0.7982157527037199,0.5908026189709223,0.5490941313999816,0.08298771865266463,0.22278505369917112,0.6725245753737557,0.5763305572739942,0.6274958280205122,0.4633935339720493,0.03318450036402709,0.39062387253591124,0.07605508527134475,0.004926673160401629,0.7760010874056308,0.554441721271003,0.7522338845461545,0.8477969688762833,0.4834056405383309,0.6906706553902198,0.6893411782724631},
        breezeSquaredDistance=106.92509315091644,
        sqDist=106.92509315091644
      },
      {
        m=601,
        nnz=66,
        indices1={0,3,4,10,19,25,30,31,32,60,76,95,97,104,105,147,165,181,193,238,243,252,261,275,284,301,317,319,323,325,340,346,347,350,356,358,362,373,383,389,392,393,403,410,413,444,449,454,460,474,477,492,494,500,506,512,517,527,537,540,544,560,564,576,581,589},
        values1={0.002658746829144465,0.6803374208277099,0.1249263730813237,0.46707719545505244,0.673228567841927,0.8441708349831388,0.25060646336039794,0.22822707954178845,0.7729647268393314,0.23405821808645044,0.32738956828156507,0.04351575436875876,0.992434882801151,0.13753064675836657,0.06729369127643481,0.9272214986155841,0.2851799473191683,0.023321435702801208,0.6158349028599571,0.7421427036830331,0.4086683955008482,0.12197458190476396,0.31058957217836414,0.7054594058778929,0.48314617706321894,0.6984895141767161,0.717372205543286,0.7400282774492557,0.6300584796104421,0.38361042232860065,0.953458603982892,0.8018785837770133,0.18628931057762166,0.06025020454776353,0.4449799232654197,0.2726847084858047,0.08128619605409093,0.8376724568529185,0.5595579741535398,0.8702491853396639,0.7112060713466339,0.5884376995570025,0.0054474961666788335,0.3005366693015611,0.04754056056665101,0.3717527438801984,0.49489704075224206,0.0515587123907002,0.7772474859933675,0.8217446577895748,0.9321344978388763,0.3124157565847743,0.9872369156689705,0.24031434119515804,0.30532927780586083,0.9900612290694679,0.2781299835808291,0.7016066441993943,0.5370782304584878,0.19186016361038405,0.22052871020610698,0.9487673576194532,0.7794078996555679,0.34377268701543284,0.7516058720943406,0.2435402161193846},
        indices2={30,33,38,75,76,78,87,88,92,97,98,102,126,133,144,170,216,219,224,226,228,230,242,243,246,251,258,259,269,270,289,309,318,330,339,341,350,351,390,404,420,422,441,450,455,464,467,470,474,480,487,489,492,520,525,529,540,548,551,556,565,575,582,594,595,600},
        values2={0.06108176605181237,0.40536072999877193,0.34796964801158536,0.2280234106857253,0.09655685049510387,0.583890787696477,0.3975941645277985,0.6945878963945081,0.01295749315212813,0.6552586045391658,0.9524881500605957,0.6964096460725424,0.44258662147978667,0.6872902183370672,0.5556628575023818,0.5410710799222794,0.60467928897187,0.810463991546315,0.02908104778294396,0.5493055254760175,0.5450888051709616,0.9190304528845037,0.39545156337312026,0.5750091283025417,0.40526683159504673,0.4406792281006925,0.4784419712525829,0.5096476740664161,0.10399105904744943,0.07798226016332721,0.28595431732390364,0.6493847915543483,0.17173871407854913,0.35159935585087243,0.09067874688146593,0.3081410055277777,0.9903003844586252,0.10824081418852949,0.5879606434781648,0.47092532938555454,0.35917286951981353,0.8956392737194533,0.6330868309044881,0.5991645720843629,0.1354664065787281,0.25229056955575646,0.8384170134393731,0.9233877185676846,0.6755055137557175,0.5114817198546854,0.7453566718468173,0.6885061761951409,0.9439990973730362,0.6771315107797491,0.3769880404509255,0.8530629473549013,0.4506003456265869,0.2932271135595468,0.7242464150132759,0.6862068575357655,0.623872072424825,0.9991481509021155,0.12184857075799616,0.554780899859368,0.8391189289006231,0.6399269622075502},
        breezeSquaredDistance=39.34766857115745,
        sqDist=39.34766857115745
      },
      {
        m=701,
        nnz=450,
        indices1={2,3,7,8,10,12,15,16,17,19,20,21,23,24,28,29,32,33,35,36,37,39,40,41,42,43,44,45,49,50,51,52,55,57,58,60,61,65,66,67,68,69,72,74,75,76,77,78,79,81,82,84,86,87,88,89,90,91,93,94,95,96,99,100,101,102,103,106,107,110,111,112,113,114,115,116,118,120,122,123,124,125,126,127,131,132,133,137,139,141,142,143,144,146,147,148,149,151,152,153,154,155,157,159,160,161,162,163,165,168,169,170,171,172,175,177,178,179,181,184,185,186,189,190,192,193,194,195,196,197,198,201,204,205,206,208,210,211,214,216,217,218,219,220,222,225,228,229,230,231,232,233,234,235,237,240,242,243,244,245,246,248,249,250,251,252,253,254,256,257,258,260,261,263,264,267,268,269,270,272,273,274,276,277,278,281,283,284,285,286,288,289,290,296,297,300,301,303,304,305,306,307,309,310,311,315,316,319,320,321,325,326,328,329,330,331,334,338,341,344,346,348,350,351,353,356,359,361,364,365,366,367,368,370,372,374,375,377,378,379,381,382,384,385,386,388,391,392,395,399,400,401,403,404,405,407,409,411,412,413,415,416,417,418,421,422,423,424,426,427,430,432,433,434,436,438,439,442,444,445,446,447,449,450,451,453,456,457,458,459,464,465,467,469,471,472,473,475,476,477,478,479,480,481,482,483,484,486,487,488,490,491,492,493,495,498,499,500,501,503,505,506,507,508,509,510,511,512,513,514,515,516,518,519,520,521,522,523,524,525,527,528,529,531,533,536,538,539,540,542,544,545,549,550,551,554,556,557,558,559,561,564,565,566,567,568,569,570,571,573,574,575,576,577,578,579,580,581,583,585,588,589,591,592,596,597,599,601,602,604,605,606,611,614,618,619,620,621,622,624,625,626,632,634,635,636,637,638,639,641,642,643,644,645,646,648,649,650,651,653,654,655,656,657,658,660,661,662,665,667,669,670,671,672,673,675,676,679,684,685,686,687,688,690,691,692,696,698,699,700},
        values1={0.670881901466667,0.47771007135525345,0.9475627553387121,0.020573063017415683,0.7843146435830334,0.37040497367025493,0.3091238221796444,0.18393148823948002,0.60999456462194,0.030082105038258145,0.9801170551738523,0.3465194998649386,0.38702405642221793,0.16971683542438332,0.04065813438607413,0.8058119287136151,0.2254672161438479,0.9803814973374829,0.04867966142685831,0.9504734576872622,0.6995714885752793,0.2545603496237121,0.36224123581693546,0.4040103478177691,0.3671911954102848,0.8373161700712874,0.18554181653237012,0.835399973808672,0.7852676306175352,0.0681801233343734,0.8933526733219496,0.7602153565343722,0.19375946615997097,0.6432394402750452,0.18175275479393993,0.4379874852510339,0.6742063878166711,0.3747477215878111,0.11746271534768804,0.5350260799663484,0.25414789849636654,0.6546853642025425,0.2137380033871814,0.5666447414371477,0.12490822031946214,0.039048501331415575,0.24769484206142567,0.25871398568929305,0.8677973756983612,0.2612463452205507,0.652107851303379,0.8756915874814428,0.34256760814660603,0.15583905979791357,0.9641314710518057,0.2507566002687517,0.6820031367819231,0.427949167411965,0.994061694029199,0.7233997100342126,0.6578107334275254,0.9390311554977492,0.08916879962795421,0.44079939403596113,0.5355172628426994,0.19628608236419243,0.11079515757632452,0.5115397542952667,0.4198695654392611,0.03085866411855387,0.5173274978301594,0.31370231165579954,0.007271083202198714,0.029056641571603037,0.2513156127991072,0.8540911798346816,0.6080788804655735,0.14118353929465222,0.965924872403434,0.45132680389721214,0.2791232529253571,0.03417698388511348,0.49407284205302626,0.17277077954878817,0.9156021114677271,0.17709746719057173,0.3630154072104278,0.39372008400901837,0.19154006166528037,0.3526126206150064,0.5878108342104973,0.5670364603570764,0.30929264153946223,0.2729748644865362,0.9390053971925564,0.792352337451498,0.6211140308767674,0.24559094343231413,0.37304695599676163,0.05622217271525265,0.31959635418124466,0.38113399066629783,0.3383482907831723,0.07806363073840294,0.5588272922991835,0.6662499372591277,0.22558490034548995,0.5414606844076767,0.5644021810261645,0.33326214457025516,0.31772679315776886,0.11637637479966201,0.5179656333869335,0.3508789284123859,0.21346756287928537,0.0850499888368671,0.2607465122066409,0.5327612318264714,0.8471280099489169,0.5728299172560738,0.1505898888526197,0.7149080811595039,0.9087760162467208,0.3549199315145932,0.7282778598170162,0.6881701723114391,0.6802179445812457,0.9609932158737998,0.20147055655055357,0.08880259961026915,0.045681143203027075,0.3318551355448841,0.13838809414661035,0.24781993506430966,0.7104215617989438,0.595812070732407,0.178392115700029,0.07901792342026626,0.46615362877949207,0.627130534131993,0.012916412170323466,0.445878019983718,0.6791146485847029,0.9249470089353039,0.36773317154518637,0.08917232871567726,0.04473923750713327,0.008215762266999271,0.2263322909161305,0.11993812157685746,0.05233381170245077,0.9607582770445747,0.07422882249448992,0.2865928427351083,0.5338050834902865,0.9802046634720233,0.5153036820541032,0.7103115929242607,0.13241061209479943,0.7855938786068665,0.21382127697909836,0.5493912933802211,0.5206633648102574,0.52062608179935,0.749556752480368,0.1011767953072289,0.7209364957425192,0.35303719390871846,0.6385051980295378,0.1792259923888887,0.9379787841447372,0.31529226201966065,0.46793331548192774,0.2137424971759475,0.899464409458255,0.05777036519714829,0.8220739443709895,0.4149060148836837,0.8188660451267447,0.09284122936234551,0.4335523988167842,0.5115819517976152,0.7443534110445094,0.7967094406115015,0.7856728060569896,0.03199389438438549,0.23808337065731422,0.9056290470590029,0.21198181862380838,0.8282932584690811,0.042162840290941195,0.4940680635594066,0.39206575361914264,0.5635630031333181,0.6307284252451093,0.45462861362574136,0.026326630179891897,0.1776429123047959,0.32200178654629985,0.31300532080323173,0.3875217465985812,0.9272662340343301,0.9298432357876946,0.8059908906848076,0.3931398848345672,0.4563485274641853,0.771240560901075,0.026514543440466998,0.8202269937769033,0.49387166545836025,0.21433366585320002,0.09692523071173986,0.293062795107631,0.19965673730899713,0.8509901098818554,0.2702089199135861,0.7141292035217398,0.882421996579754,0.8086103582520738,0.07855444963940839,0.8800998937421515,0.799872949258727,0.6777558328243225,0.6496604693636534,0.1271203879280356,0.0171735611561451,0.025356976629142602,0.5934015595743029,0.9834358193118145,0.8479989503840939,0.48767200059618765,0.9249484058265834,0.9724641176091687,0.23147164036084233,0.9928322212814187,0.33516393321629867,0.9056997835615669,0.5086347658351862,0.74972272374694,0.745073121211352,0.23237388767653555,0.45371775592066443,0.25811174050451524,0.48843136075184435,0.2715841221125165,0.08830068418786596,0.7443564351655164,0.6548924657595805,0.44264827569488974,0.7605858057291953,0.10767619660627437,0.09600425509954325,0.9307230209629459,0.20733620198233782,0.6738992616280517,0.3472358759229546,0.5772698278235477,0.8326426412320166,0.7967518984631103,0.25146804159497516,0.16873781296582113,0.2355317493834067,0.6211742269650813,0.3828532295235789,0.7118733911836473,0.09753003071027433,0.12880996918502996,0.4646803828745034,0.7303549590663956,0.9016496437625269,0.9227321604192535,0.8508542836075308,0.09499028476919136,0.5958637046166869,0.07663057252354188,0.7978270291757553,0.4085031010297059,0.23699030449451952,0.7731006941293789,0.6922951650747818,0.5059747645495424,0.8550058980991272,0.3863383230506089,0.6197029075616156,0.20329535259562725,0.2631603769347377,0.12645760329148348,0.6595681047718795,0.028518660991036726,0.3058678542756871,0.3558149939609222,0.07587453085806506,0.30480302952676985,0.0841984784945905,0.21213467176701917,0.13425047534862233,0.6186608756133846,0.02789824891094328,0.22889617651687466,0.622379915129612,0.40352720155371935,0.2932154159468806,0.2303583441394772,0.27606977805053756,0.09619754775329858,0.8574138137928147,0.8967576250089004,0.22062251116573905,0.08247427413348529,0.853704475120159,0.04463360775987868,0.2256404971873649,0.4383994663923071,0.14442881236372695,0.8478979039976561,0.041115048229473095,0.29474172225533957,0.8656786544652927,0.9371769709016177,0.3336291023709058,0.5049428734973245,0.6931388327921918,0.5581235410972877,0.7737298923990464,0.1805204300790667,0.8767907044237693,0.7438051519284837,0.6390036760559843,0.5729597643443546,0.6712160512274118,0.7619427134703919,0.8921118699078217,0.7274197064857462,0.648592255485068,0.9346855467620158,0.06902408139943228,0.31111421125351013,0.5230715421817311,0.2967740661746877,0.46991003115357954,0.028021393073184853,0.5380884407550046,0.45735475427588634,0.08362937893884348,0.0716108385574673,0.17224115548419183,0.4613765340698126,0.39648447714569357,0.1385690825220538,0.9047441990648305,0.4084114429703075,0.7368781016322025,0.6290414760426382,0.04805124455517018,0.07990674307252077,0.08974446329097174,0.7926990203270429,0.20309841857383581,0.8502896969931242,0.3780983575304562,0.7449765880717567,0.7217203705645844,0.7130100040297256,0.05377429716746018,0.47411864076386045,0.6711422782585904,0.3395193558285857,0.4654033770747138,0.18720764718819305,0.18705331937770986,0.7073513632389575,0.8789028354050561,0.602139108920715,0.7746179695933121,0.9828792249501401,0.21422919861866008,0.08254646081482486,0.07088360800515925,0.02499271543509729,0.5318732527844174,0.8339681549412347,0.8173941334627559,0.0878497388134668,0.053550548752124394,0.7320880147285511,0.3084208845162878,0.044022450723535944,0.03376911964101492,0.7376694754499118,0.3780741424580505,0.7237711099482866,0.11243112673865008,0.267842879176182,0.06865922676922676,0.7718437530373335,0.8733530360027207,0.33969466793206404,0.4829936455532603,0.7601132847548415,0.2095646700179743,0.7796455103447898,0.965002796070873,0.16252783533400939,0.7534741640215825,0.3008944722282989,0.6757633339497459,0.19826417934783913,0.06846298773451842,0.7912446644156085,0.83626506718687,0.479638430275213,0.5182007953694695,0.7249150092439908,0.39351359095526184,0.8632418231497602,0.7309472572864147,0.2144822196616657,0.6331977406376236,0.8959336204392342,0.35833434731230307,0.8528856196704035,0.30999694743196193,0.771737472172189,0.3915986441962993,0.16046669087345766,0.19570581947070875,0.7713513938648244,0.6429608570773322,0.1483045963149976,0.5557045511948323,0.7428953420388085,0.12582483087103802,0.23664742609904799,0.9559048148846767,0.3006852399442882,0.9746964799868765,0.5260285560207838,0.975153428711493,0.06823534468588432,0.23419838789174774,0.20869606055554402,0.8521766150486857,0.4723557616823829,0.3162829194119655,0.7292725121820651,0.831499920470443,0.3071253505118111,0.1757234467414086,0.15610149336981238,0.98938006344935},
        indices2={0,1,2,3,5,6,9,12,13,14,16,17,18,19,20,23,24,25,26,28,29,33,35,36,37,38,41,43,44,45,46,48,49,50,51,52,53,54,55,57,58,59,62,63,65,66,69,70,72,73,74,75,77,78,79,81,82,84,85,87,88,89,93,94,96,97,99,102,103,104,105,106,108,109,110,111,112,113,114,115,116,118,123,125,126,128,129,130,131,133,135,137,138,139,140,141,142,143,145,146,152,153,154,155,156,157,158,159,160,162,163,165,166,167,168,169,171,172,173,174,176,178,179,180,181,182,183,184,187,189,190,192,193,195,196,199,201,202,203,204,206,207,208,210,211,212,213,214,215,216,217,219,220,221,222,224,225,227,229,230,234,235,236,238,239,241,245,246,247,249,250,251,253,254,255,256,257,258,260,261,263,264,268,269,272,273,274,275,276,277,278,279,280,284,285,286,287,289,292,293,294,296,302,303,306,307,308,313,315,316,317,320,321,323,325,326,327,328,330,332,334,336,339,341,344,346,348,349,350,352,354,355,357,359,360,361,364,366,368,369,370,371,373,374,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,392,393,395,397,398,401,402,403,404,407,408,409,410,411,412,413,415,419,420,421,422,423,424,427,428,429,430,433,434,435,436,438,439,440,441,443,444,445,446,448,449,450,452,454,456,457,459,463,464,465,466,467,468,469,470,472,474,477,478,479,481,482,483,484,485,486,487,488,489,493,494,496,497,499,501,505,506,508,509,511,512,513,517,518,520,524,525,528,529,530,531,532,533,535,536,537,539,540,541,542,543,544,545,551,553,554,555,556,558,560,561,562,565,566,567,569,570,573,574,576,577,578,579,581,582,583,585,586,587,588,589,593,596,597,600,601,602,604,605,606,607,610,611,612,613,614,615,616,618,620,621,622,625,627,628,632,633,637,639,642,643,644,645,647,651,657,659,662,665,666,667,668,670,676,677,679,680,682,683,684,686,688,689,692,694,695,696,697,698,699,700},
        values2={0.7106118873298284,0.9008668315531102,0.13706152682727324,0.5046450058321018,0.996641355283897,0.17991746095328653,0.9402375479903421,0.25817886154668845,0.6961388484337149,0.6567510766482135,0.9977666316426211,0.36334311344856984,0.7544709288724846,0.5351663210561324,0.6055120960899834,0.13184772194702332,0.14008279476806884,0.3889008002600687,0.7964221394411847,0.4159334817798557,0.27952462384823107,0.6939505088131074,0.659063547847078,0.6875173189892426,0.6669704236865067,0.38429707978628236,0.03830459908960926,0.5462782050008352,0.600897293994252,0.2892277410312838,0.6806786419030012,0.30051331438532114,0.8531308083848987,0.3270345896559166,0.13012206113945946,0.29682016853597115,0.9592522814658683,0.6277306583463502,0.4541960093929237,0.4881372513271167,0.7344020677253997,0.3365228918233767,0.18656404907215285,0.32440220976893586,0.5648026770444918,0.7101323474603584,0.7084128311682357,0.4260630839294405,0.002863854580830494,0.2596550751386568,0.6596665171092841,0.6579049847283103,0.2025217063637733,0.11650713809831637,0.8702596758805836,0.15913066119496355,0.771502058742429,0.5020999352116609,0.7323980388257817,0.6053602436631661,0.6884882302317449,0.16724314383547223,0.896649578763087,0.479192475396641,0.03571175163025364,0.9338738603112801,0.6678734149239823,0.4081950598570597,0.4312738575374646,0.019562721649196035,0.50140764818702,0.6926698543881775,0.21054492531145297,0.6543488160826236,0.5556009369554872,0.9902639306610841,0.6022776514153138,0.609806984071179,0.3436876547102974,0.7504748406829909,0.3726089711092966,0.6518526467771455,0.14616959220643133,0.39932467507411573,0.6689150836176441,0.6016408442676626,0.9942815395187591,0.4629541081755507,0.08552241305527675,0.6430177952064212,0.715782573192901,0.7886143390457474,0.2945670464055752,0.7503346459670276,0.7462282001190487,0.7725110624880023,0.9378338340165983,0.6270349347858016,0.1520430715083252,0.03618157672242639,0.8591954204464455,0.34327873190258773,0.5861280042741378,0.30656239385956463,0.17231072581820062,0.9399676233292745,0.7023988610306082,0.34963145804196905,0.10453144761197175,0.626887203855594,0.8925690696653278,0.6834854297272894,0.03550386591550447,0.8442840770809918,0.07665182159418371,0.4539393422603245,0.6577429675813665,0.3800470118994549,0.6780714547979768,0.29421236965115594,0.7264940934980578,0.9387627185371779,0.8449385430563054,0.2099896858593715,0.43748717692540007,0.04426873768889006,0.44095591703297154,0.5321278018861512,0.0737273483505938,0.9239273059712301,0.3225885706446916,0.761496208352785,0.19625455979372364,0.07069538075837578,0.9435429734792596,0.6939257109141814,0.3188443759650992,0.5081682758639875,0.3832661707455137,0.5579597687264936,0.7029107904424734,0.39412510289166547,0.48308904728933366,0.02408208466582107,0.636411223000725,0.4897062477130113,0.8918020513589784,0.851319966248834,0.3193426367040799,0.1942046195063557,0.47186550214820466,0.6255996809220333,0.26845709794849415,0.2995540318502061,0.6981213857680713,0.5139568556398239,0.9751140164357923,0.3539490962577323,0.39278692281466543,0.20968081575670783,0.40272522190873516,0.5406336336340124,0.38367423837158254,0.27569915541310985,0.7940385415226463,0.27574493433206326,0.44699531622331057,0.9069848303676984,0.17354375842825887,0.30820396134614736,0.20177451025898674,0.7274948252899526,0.8765750665498334,0.9649918763282783,0.45980562988121376,0.6131260768054644,0.4142221865348874,0.326756200545702,0.9032541218764849,0.6894006522691222,0.9919518391127228,0.541540331910463,0.8614197761577953,0.5910690714964177,0.039880213366931705,0.18853237594605665,0.38883818528333225,0.790546907516585,0.18392629787071446,0.5890805413946231,0.8088147305651302,0.3030766794218208,0.18961470229393584,0.22882393690755298,0.37964759277511706,0.35873327407459865,0.5440860333567892,0.002639454100404004,0.7652112295255575,0.6948679554975957,0.506911481958287,0.8232062377886732,0.5472354672771087,0.9673125173360275,0.6565978458902251,0.24434197688412496,0.10352938823248359,0.40464157307111637,0.18720793681710113,0.14186542887369724,0.7945634467989244,0.2370178226120152,0.46831046775840945,0.16759250693671546,0.5502372351100144,0.6196212649146655,0.6715127007216033,0.6461737408782992,0.6293241365949237,0.7403903834975352,0.5881178169599913,0.819833098789109,0.5359986697418272,0.552779497204274,0.1149887787965026,0.8626696414981502,0.8210159918942235,0.10646324731934165,0.2694885508409798,0.884034619192937,0.7695269823359463,0.7623956603025914,0.009406337200196457,0.21959904816766485,0.7831770766034511,0.6733578300074886,0.5800684963433886,0.6690771131592069,0.6010501212208683,0.7871048701746355,0.588371225257984,0.9811737700201548,0.3721834765583909,0.28644918863132585,0.5122620902764838,0.8091752952385548,0.9917940625065396,0.8190938505195852,0.8942357601217638,0.5647034898763955,0.04401917780608866,0.089756441589398,0.03869893694365467,0.08250615673555484,0.15589056526317668,0.3880999819968828,0.6355978906024623,0.775757541209257,0.5604231661418299,0.40821459605750965,0.3664920412180599,0.0091940888506159,0.19111537577879223,0.2788698023652968,0.21429489034905758,0.7465127536585022,0.6858203423157183,0.06848383740825359,0.8941937126413626,0.13881028147395025,0.2648632909082851,0.1547333344858529,0.5507979875930868,0.6124435400870164,0.5664423742117186,0.7559528158777505,0.6253554378683802,0.18754269914539534,0.17176633033947275,0.6099502801381249,0.5869142082923722,0.2125105211043129,0.7330446557307974,0.25559184363186405,0.04259808211041649,0.4351924476808382,0.32936122662324907,0.6234844342490523,0.5947013705062779,0.34800397180728804,0.9186258587594743,0.6743127237721535,0.6960985157344242,0.042153227859795916,0.5282123561333748,0.6368626778587415,0.6705030060251317,0.38519826000420043,0.132555972283937,0.9924908040588644,0.010399123528311849,0.19652996534638278,0.0028966699803721907,0.728774554245129,0.043008901216963324,0.2369735979247507,0.6825194863943835,0.5423062376615398,0.06344613632735396,0.2515526501365445,0.640256531978193,0.609068972796479,0.07424790645432411,0.008561269231655122,0.08567966739381094,0.2605601107697769,0.34176341387536824,0.26344210800314216,0.3913270152375523,0.4048039481960448,0.08241907116278946,0.8425688396011051,0.06047020177630369,0.8136220244939397,0.7256675217580735,0.5898835211649268,0.203343601737499,0.46100606106889974,0.3654674930835865,0.7484410433009281,0.040420684280262575,0.9421652006702878,0.20843076853519504,0.4592640257702175,0.038236873702019,0.6287953315884289,0.054310901539047274,0.45151333832158125,0.9014219968136293,0.6233454829334922,0.10329809806279389,0.6708310304357695,0.7940201336826609,0.7635323188523556,0.6746234303485532,0.5468137703347286,0.8438377926862259,0.8980804889355145,0.7422643168678728,0.835926801120682,0.19547641551411066,0.4056433684937959,0.5460829354597997,0.4927696239444709,0.6208684980247146,0.4610849348965308,0.920517752732411,0.8204563067531214,0.9705510242093807,0.8667802923459899,0.3979875902367278,0.2299752093111378,0.5545740373547162,0.3613188130499724,0.5904567572936563,0.2987438932414507,0.8788559254005086,0.19397078260581457,0.8301487467683029,0.4601769273365839,0.03096143445527133,0.4105041525947213,0.5591851860707279,0.5789357728369594,0.4086921596443347,0.7344158219629859,0.4979656098749724,0.8706317156217374,0.4155435923277302,0.1473670372659499,0.19339297815171608,0.1101037400175936,0.20899660964983258,0.2735903399859888,0.15058848120898372,0.8389955175742434,0.5807756343522552,0.45526100501841726,0.3855286022506834,0.3312070785081387,0.572619392604111,0.9693032654729359,0.9010765746108111,0.4038975714031482,0.4867747602967324,0.1808278398320362,0.2851687984647572,0.7720685846963145,0.537337780970467,0.5543733964217458,0.3574566758301332,0.5363571241255604,0.5067301706146301,0.3513524548282303,0.5494926879145221,0.5665209195515948,0.4210137211477326,0.5305770957668113,0.49358904265438297,0.997198553586752,0.43840919896111663,0.8384677798493478,0.11676599997286985,0.7878796985939521,0.8573000710533307,0.3265244506033861,0.388746468376023,0.315621496168055,0.3931657220762351,0.565865868401912,0.7567417367568733,0.26689945006295124,0.6483028122837999,0.642119612474215,0.21481325481885416,0.6740817322160163,0.0038574712521878274,0.6086717853164864,0.901883717491837,0.8023687092733596,6.050061157152342E-4,0.4522620980006694,0.1000098464911604,0.7346395386258777,0.6430781729724958,0.7821363186615827,0.5133190318494502,0.9245006549791848,0.9610586388642527,0.3924449685985898,0.7480496858214799,0.6919315213831634,0.5931108374662807,0.5673036227789715,0.9854258523197722,0.6212751906538531,0.11875098267909767,0.4989062140756785,0.9416343912220945,0.08792230222031416},
        breezeSquaredDistance=140.0336710066379,
        sqDist=140.0336710066379
      },
      {
        m=801,
        nnz=185,
        indices1={2,16,18,19,26,27,36,37,39,40,53,56,60,66,71,72,73,74,80,85,88,90,94,95,97,100,101,102,110,114,115,124,129,130,132,136,138,139,143,145,146,147,148,152,157,167,170,171,179,184,189,196,197,199,204,212,221,230,234,238,240,243,248,250,257,269,272,281,287,291,295,301,308,317,319,325,326,330,331,332,334,341,345,359,361,362,363,366,370,371,372,375,376,378,383,394,395,399,401,402,407,408,409,416,419,421,423,424,435,439,442,447,455,457,465,470,481,485,486,487,491,496,504,505,513,518,519,520,524,531,533,536,546,551,553,565,567,581,598,599,601,605,610,620,621,623,631,638,645,657,659,668,670,671,673,676,678,683,688,691,694,696,698,703,707,709,713,729,737,738,748,749,754,755,759,760,765,768,770,777,781,782,790,792,793},
        values1={0.4242893138501618,0.22082935051978836,0.9306208911957821,0.826678849331715,0.07546842571257217,0.6753987204722062,0.7307690613142304,0.29706580160053764,0.5068545307306542,0.6272572518753076,0.6653609639738725,0.7847024650876573,0.23163174991641045,0.9665457034233629,0.7582478865404272,0.5675494926527497,0.6095527721417808,0.21775337601695965,0.14834833684142512,0.07579120493103242,0.9714618546884111,0.8312088098759084,0.8498737630506716,0.3307820265096807,0.3489404097654827,0.12620950033777745,0.13044835250320186,0.07196308982833177,0.6444330205341363,0.11397052085853443,0.6066409322285581,0.7867451721235962,0.20709383721471997,0.5662672320110007,0.11443443281159404,0.9491750005321883,0.8157273745844487,0.989592799341448,0.7764164758534217,0.520271556678369,0.012578998226472349,0.6148462510331557,0.4579821968165144,0.16623974868696123,0.5803647640278321,0.11901233642053355,0.9815985965891069,0.7103391011590112,0.7098118627834861,0.5579895746265114,0.05118717068920264,0.05000540415922938,0.06611427910184564,0.90866851793014,0.8279394122348223,0.142893173262446,0.530091344763829,0.6935569365969271,0.49438799383225895,0.6938280923298213,0.8634687720938038,0.3926950132280578,0.9453136036689191,0.8592276732487919,0.9275858157158969,0.7352974981776874,0.9520758669229408,0.6263695235127816,0.370963722526068,0.5075065472726328,0.7612140664266246,0.5219568084995245,0.8935545667969007,0.21283327452798195,0.10867166191429933,0.9577503862815163,0.29412151930456054,0.7783117502850031,0.057755898391983584,0.8306080645766309,0.5120851574056411,0.5120844859660448,0.9019521028428625,0.9600910233297093,0.7863024131483382,0.6870836833693073,0.6129698958967836,0.5688682999124784,0.8706284123295337,0.45066792753296836,0.9599059978831875,0.289470529097832,0.9697435900584482,0.24151909084604128,0.4771669726631039,0.11551376249715362,0.6886118047710135,0.5327998565398502,0.9168019538497301,0.30633565053993683,0.8250673881759053,0.5145175380871604,0.6851544131119411,0.5010554565040931,0.2774128157099288,0.2782344693425447,0.034248665345062435,0.20139045889820073,0.6875400715341062,0.17371210400629122,0.45508562034371214,0.34213114150850354,0.6949734167489873,0.26976928073216355,0.8030293662170819,0.8839983750255883,0.8383622203084279,0.27058231760607243,0.17472438207179664,0.2356752059748748,0.20833684221576843,0.8138485591419851,0.45149112574230565,0.8401276427839697,0.9292723075305168,0.808680985384247,0.7259047858236971,0.4448974219966021,0.4273880137352033,0.35879645143387906,0.5362708975728625,0.41687146797961117,0.22874426109969248,0.8605060534859432,0.947968380385684,0.9591022774494388,0.7230788650024229,0.06521034696788075,0.041138996413695006,0.2405740738255706,0.9280608120269742,0.2525486969183486,0.29095957324447375,0.2593797360796012,0.7934196990018767,0.17304640529066473,0.6597416645984222,0.7255940468551053,0.995543301084282,0.08804893617740717,0.9593605108245182,0.3721988758190894,0.4905179669636546,0.059928177126160165,0.1880236941030231,0.8807361870227209,0.317219618134452,0.6269900555591313,0.09714684105638671,0.04293560602633184,0.2719456981604603,0.13520955010006486,0.20211255009894935,0.8703827963327164,0.11221143060235472,0.29286292233948197,0.8149454784149489,0.11136572768020381,0.8897166196588843,0.9643234778727215,0.44744517765166725,0.03735629773468552,0.8611216824587614,0.825731846173858,0.11007568900645281,0.4211545446761076,0.1801546794161596,0.2679474335394688,0.6149186470935945,0.3445437982508658,0.2357041236742764,0.85113260851357,0.9802547425030773,0.8453743871097116,0.06793460205411739},
        indices2={0,7,27,33,35,39,42,44,46,51,52,62,67,89,101,102,106,107,115,119,121,122,123,128,130,131,132,137,140,142,146,148,151,153,156,157,159,171,177,178,181,186,188,190,192,195,201,204,205,206,216,217,219,220,222,225,228,249,250,252,266,277,278,284,288,290,296,300,301,311,313,315,317,320,322,324,326,348,350,351,357,360,371,375,378,386,391,392,396,398,407,408,409,420,426,427,428,429,442,444,449,450,454,455,468,473,474,492,501,515,519,522,530,532,545,547,550,551,558,559,560,561,562,563,569,572,575,578,580,584,588,595,596,598,605,609,613,614,617,630,632,635,636,641,642,643,646,650,651,657,658,667,680,681,682,683,685,688,694,695,700,704,705,710,714,715,716,717,718,734,735,738,741,745,749,754,759,762,769,772,780,782,783,785,786},
        values2={0.3424935567914894,0.43577915542577894,0.9633235822155962,0.9505428042285265,0.3356457032777095,0.0509731727626912,0.5497619089329381,0.9915214523819192,0.49406588816524577,0.36356799433850484,0.5472159170700588,0.2813927263683468,0.4062872963895303,0.17191488956349288,0.9284287040460266,0.2712989239669469,0.2400615184827718,0.34249277699099523,0.5994614514398651,0.8749760112548433,0.8170923857603198,0.9132068954409482,0.12789499401475402,0.06335335692870547,0.6585616488688256,0.3568787620525765,0.3814745440633488,0.7905635962711591,0.23939214828355249,0.12983643411975443,0.9582099514160904,0.14824428140006296,0.6393890365731314,0.9010207117513718,0.1922632824160203,0.9936449301364524,0.8858455074232924,0.5337818822611199,0.07952659587271338,0.5519360217417395,0.5448945624861367,0.9755485188839103,0.6826127939473562,0.6542499121682468,0.5378332746505964,0.6998082226136745,0.44705274670103634,0.34036572149649547,0.733842096615047,0.24034784618888827,0.3888119644148502,0.5285833958859958,0.601966334475572,0.6594583042677414,0.2978112628679883,0.33521505434139964,0.09292262473099266,0.4998173582971418,0.9429547658760838,0.4122542478811758,0.9652386444334949,0.8840212038667695,0.7612404915578853,0.3641668240645941,0.9704290352571479,0.9462435341487344,0.6668476688457635,0.9033797943139417,0.6683566595737069,0.7072588563434137,0.4256663123120167,0.9089274815043316,0.1566228797859448,0.8370743346154156,0.506554184716288,0.9638468934530179,0.6667761986788591,0.48867223178116015,0.4426770035160924,0.26429726066559966,0.8053241561179129,0.5318732273094131,0.514607856486603,0.01701126383098639,0.19897799668477112,0.06808826422188463,0.001432236241790119,0.5715687458852727,0.4412556730794479,0.06473450804069036,0.33692507917403225,0.5701157327369357,0.531513504420856,0.31234899528475824,0.25493735516231864,0.3395353710954274,0.4476727405382367,0.6779412644414379,0.4114486879742305,0.5997092357843082,0.10035166605131951,0.8048838180419207,0.03031431860346412,0.31639107283769663,0.6788101983590556,0.9926474651123138,0.835553881808465,0.1883473738369441,0.3180585408108878,0.9789463659727244,0.9051003158890057,0.8258021435928826,0.09167714773906122,0.7423649163121745,0.10924757678556174,0.15085606745851288,0.5663403429530812,0.2452972528169335,0.48160563520764066,0.9304329466629558,0.5417313763135487,0.24503699422890357,0.21119245174391865,0.6384394206421372,0.14348187826349423,0.9151137685644256,0.9413617629074026,0.03620629330050473,0.13696429495671203,0.03947972348972795,0.7145869964677607,0.9589130732150775,0.18621083929739346,0.9689079385674589,0.21169108627903932,0.8005799719594059,0.7949278188748371,0.36197204289340235,0.8999326831820055,0.1013442207305093,0.8355200047493176,0.972234103167114,0.3264294862081364,0.45812074445184336,0.897234346192589,0.38877607489181154,0.07171966877746383,0.703379752604614,0.1659779913785051,0.6889672832589417,0.8128328564813253,0.9266568294988672,0.18606116977227738,0.42036890452724485,0.5360621558213248,0.4495435755523072,0.648060015301969,0.19293366055278316,0.18669920120481454,0.3072903002183298,0.297190587225468,0.4331670494313403,0.9463147676505834,0.13878429740834142,0.16303004868652127,0.5286742814895976,0.8877370565479361,0.6415506172030674,0.5741166946795383,0.6745247019088608,0.9737010879551041,0.9095549120818154,0.8399053890673122,0.22212338062548975,0.2372119106216889,0.03897050766632437,0.05775067315092863,0.22678743880235996,0.5099856381915917,0.36070522114657155,0.2340350645770899,0.1919824547975164,0.24990164337645449,0.5383654197578729,0.7962550687999468},
        breezeSquaredDistance=114.97943817002337,
        sqDist=114.97943817002337
      },
      {
        m=901,
        nnz=214,
        indices1={0,8,13,14,19,22,24,26,27,29,38,40,48,53,59,62,63,64,67,71,76,78,85,87,88,93,109,111,123,124,131,132,133,138,145,146,153,154,158,159,162,164,168,171,174,179,185,187,195,199,201,213,219,225,234,236,240,246,249,253,265,266,269,270,280,281,283,287,288,289,320,325,326,329,333,335,338,339,340,345,356,361,362,367,382,384,393,402,403,404,415,417,419,420,425,429,435,439,443,450,464,465,467,471,477,480,481,485,489,490,496,498,499,501,502,507,520,527,538,539,541,542,544,546,567,568,573,576,577,580,583,588,597,599,602,605,611,612,614,619,626,628,634,635,638,644,646,651,662,663,665,668,669,670,678,682,689,691,695,702,703,704,710,713,716,718,723,725,726,728,747,751,755,760,761,763,764,771,775,779,780,783,788,789,790,791,793,799,809,810,811,814,817,819,820,829,832,835,836,837,844,846,848,855,857,863,864,871,875,881,883,888,892,896},
        values1={0.3058324590376782,0.7217866232693657,0.30012727998438693,0.42923952867185,0.11060877228545174,0.6647719824803429,0.02852349731704018,0.7821061226384048,0.18201638803396714,0.40339228774733393,0.06350635191479859,0.7242222039750495,0.5991743480492305,0.6431168866414225,0.28666108104624066,0.2628809587423713,0.7010002953906785,0.8335890223578309,0.793390336431717,0.20352455257304392,0.2273569869113654,0.01141849297068065,0.12253546830364481,0.7777467606319763,0.13367679148602218,0.4621812780865383,0.6731629571519262,0.06671442192153909,0.19652658512105092,0.23827811737826754,0.9850602968278661,0.21027244265956224,0.46605164100103746,0.6093425495161937,0.2635871243558058,0.8226614405730412,0.3409637636911813,0.5931780908525914,0.5148789230587142,0.9976909810292636,0.5427155553070099,0.8177434697127595,0.9240019133201747,0.7793755265322476,0.5477293125806901,0.09849383627821351,0.6565099964745846,0.9984541668041619,0.10002530957163847,0.2804244759020399,0.09295544775419096,0.9308793197801181,0.27132119417156164,0.09045371732532892,0.6162569375185538,0.32127396887621773,0.16165063604066832,0.9733193041440253,0.46343026366092266,0.9325202579381384,0.7407754774034898,0.1429528822278593,0.8260380229583083,0.9320572484626746,0.5191432294677049,0.37133563454218155,0.33781703231792226,0.1061291502578251,0.7068671753230927,0.35812719488201583,0.3232929070818247,0.10513946773199423,0.2701837126518951,0.876899227151348,0.697793180446518,0.6664308869505937,0.8270676926867853,0.27759400507358045,0.20712230492566952,0.03522415647476029,0.6371633376404454,0.3398675050430131,0.7742624427253451,0.6101141315924633,0.03591467010970384,0.9182653361757029,0.08081665848725428,0.17643423390802704,0.5387561736981155,0.29771915565963036,0.15251181766260646,0.9589657751797476,0.4984507153329474,0.6866402644772033,0.6409303407545636,0.12488125662455307,0.6371384905454333,0.814925818675452,0.6977419843343277,0.2984765748871123,0.9943873519939133,0.1754825676720777,0.8230573451645592,0.1111590399526865,0.8335112295287996,0.050412051515932976,0.8361275243432236,0.8033243596011789,0.8306501474807694,0.09678970886503979,0.16446505257668165,0.41916788020053286,0.43458186144229627,0.9320101995467263,0.9765631629676371,0.1911408304002794,0.629961506718033,0.8549597775161798,0.29374210532903966,0.2976755791810116,0.4626623208764885,0.5668157883896185,0.1082523217011011,0.2959682858994819,0.5931173989381024,0.5140622972173805,0.7076166302864206,0.18102147613969455,0.8320383993926241,0.2663502814432622,0.8592941887014035,0.2028126359076169,0.0826140199979758,0.1631193056567355,0.24510128003196685,0.28536988964770316,0.3642678312899036,0.3154372000456642,0.5514255322944818,0.1346987576439399,0.625280947868641,0.9333030413467026,0.9191209392308796,0.8969190777240135,0.8650625809240907,0.8636977862546141,0.03607373972350936,0.5336345952140673,0.6815768311092786,0.1709562326903048,0.015779840989477822,0.9184719622872531,0.735411932045791,0.5685725707614621,0.34687677729727684,0.02689019815384952,0.7792038028753117,0.5203414953244652,0.6214239178862331,0.4907750614774641,0.8396025512183394,0.8687751376731377,0.4538271278229361,0.2199979134763036,0.8586973829787604,0.9200259450734984,0.9876549313324281,0.7550315406717902,0.6027917607051735,0.01708412830285344,0.6541951258057306,0.5078801430971092,0.9286471739308464,0.7668073759896517,0.3944523902035788,0.07299501199907854,0.5607903195465059,0.25138011098051216,0.38538857493742296,0.34551051599533655,0.378205642476525,0.751088013956169,0.42155975024520187,0.27105009003489955,0.8347108513576246,0.7328329790436516,0.4949045377426232,0.6695153861738142,0.5445404937165697,0.11760251570473912,0.7882909722492915,0.724685968403527,0.253138359129664,0.13014686909839446,0.2525297125181497,0.41212117049967734,0.38288710231243706,0.35540606726060886,0.17191371443825332,0.34976934534334914,0.09447877930066251,0.9787681499525269,0.6399455780072699,0.29885437043427654,0.3368575882037256,0.5710290206992205,0.6647654978229773,0.8170229108081865,0.672142291049231,0.19396321353985546,0.7028945197782775,0.3714001270091186,0.7566621147143641,0.048704258503785014},
        indices2={0,2,3,9,15,17,29,30,37,38,40,41,45,49,55,61,63,69,71,72,79,81,83,88,89,93,95,100,108,109,113,115,116,129,137,143,155,160,162,163,171,173,174,183,186,188,189,194,196,203,208,211,213,218,219,222,226,229,233,237,238,241,243,249,252,253,261,267,274,279,283,284,286,290,294,314,316,318,335,336,343,344,346,350,352,361,363,364,368,374,376,383,384,387,389,402,404,418,425,430,435,436,439,440,441,442,453,455,458,459,471,473,476,478,479,486,488,489,493,494,495,496,498,501,504,510,518,519,524,525,531,535,536,539,545,549,554,558,563,565,567,578,584,588,589,590,593,595,597,608,613,621,630,634,640,648,649,650,652,661,663,669,676,680,682,683,690,697,704,723,730,731,734,739,743,744,745,750,752,755,759,767,768,773,774,776,778,779,784,785,789,791,793,798,802,808,810,816,822,825,831,841,847,853,855,861,864,867,869,874,880,888,890,897},
        values2={0.8280734768538895,0.8115890541484245,0.5142707310879937,0.4917141956124276,0.7944957644545619,0.3085100658072457,0.6804211224166624,0.38757207340771327,0.4171631802676058,0.17404584822212055,0.9247693592779166,0.9705690652517686,0.7470384715795517,0.612190464191192,0.8886753912024712,0.14528426797597405,0.6437079048909153,0.31464612580102735,0.07113799706471491,0.5235253949129529,0.19018464204076624,0.5991080749138574,0.5450551493294559,0.945327365843056,0.3414318921391676,0.4108847162715953,0.46288320669016403,0.7486776284475404,0.9299272922517958,0.8397396765247584,0.6278491406387375,0.7372176914123038,0.7775669306106274,0.0313803075957485,0.798470404466552,0.41333390339666953,0.07043334620117525,0.6318070006964568,0.06698934348149532,0.19346533135407262,0.3414289083710772,0.19277648820300275,0.6064305108244824,0.003119725735644008,0.37550239657636797,0.2879212020326458,0.316340430623405,0.8610033318825969,0.1031728254665073,0.4416061464020655,0.41387137182084666,0.8048342130238801,0.08028192041053717,0.3563936463956334,0.8147221462438643,0.7858223867882494,0.4653821481511955,0.3400253029799737,0.2275501362741008,0.9644649043284985,0.5008948847561119,0.2791196391763079,0.24582091271965267,0.1772173666334057,0.3801488966832446,0.9843231269343689,0.36266298503552996,0.21176766055577279,0.03963642667250622,0.24044103320154375,0.7571467004859067,0.9280520730477414,0.8543007728579697,0.4351138747308385,0.9045083742118935,0.19281754180000865,0.43339540147096856,0.21089415143762025,0.5481916301262519,0.057448054441116336,0.715431532866692,0.18811722735944003,0.33818006218826346,0.6019373567074211,0.34295758036146606,0.4397491653502842,0.48794654115064773,0.39230414274135617,0.8613906061775262,0.06443336907936581,0.1314462089263212,0.5544097630140027,0.6308460157731,0.9002472821236445,0.6719316762378215,0.054052852948888175,0.4658887695227435,0.14921878293696633,0.3059706758258909,0.8913792938799834,0.9253557503737283,0.4414418890491101,0.07889769304910588,0.5670596420138695,0.8628755414131751,0.6576693379140864,0.2820329263836855,0.35835071817109754,0.31843823159809936,0.650549985934817,0.7373534727655214,0.6550717574236324,0.08234486039507494,0.85721660553903,0.5319027676957527,0.8486897144284894,0.2950922128293997,0.6797200761984985,0.062076780992726066,0.04212239633460235,0.26022537557158054,0.424843928663044,0.8270259232556628,0.1535321996222443,0.24191737476145048,0.5411229145494675,0.27076407882231945,0.8242968981859315,0.3950112047990355,0.8684282919933456,0.11417717628382718,0.9095088065204388,0.13248656146736737,0.6242710956581532,0.04097571105747777,0.22876677358539232,0.17378989886224305,0.891014390425713,0.3057367387638611,0.6856902770739927,0.23719324468152314,0.43947403818105135,0.8175328513477944,0.8264983147565139,0.840323474489497,0.8269269373170834,0.5192467418835732,0.4011605711230185,0.9552304162944368,0.841334415594757,0.43052225987794557,0.5150415679857645,0.32783903844461937,0.5286278248080178,0.5514033912977858,0.5146234056708885,0.11635687436691566,0.23619234233777753,0.9340652557068018,0.8378061227861203,0.12918505182136986,0.33322391756515113,0.6216417946692775,0.6774489867788108,0.3501075124450055,0.527423567879473,0.8260071456661169,0.4562302209221405,0.6270095705129383,0.9875321591087155,0.6704689527509886,0.7915666716788778,0.37010365943846346,0.8024979350607567,0.05868313193580488,0.8412487682949593,0.8566167121475614,0.6606079881620941,0.7477018395093926,0.6636103604112807,0.2711197743705035,0.0157043180729991,0.5009173350857096,0.5004673265270214,0.9241577227158813,0.4226433791100397,0.2757663382236586,0.6967223024295883,0.18656272952604414,0.17044831877151145,0.7614108876456501,0.3074476150909081,0.5528124833991496,0.8191407498716787,0.22321348967392873,0.3114220057210767,0.9040199043498219,0.7550290782510815,0.5336754295198443,0.7495112655459509,0.4796183300127984,0.4192690438243528,0.47360936324571923,0.036946388371423056,0.2865324800837925,0.43580104279568466,0.8726682806824579,0.1604678132123989,0.6756018393099655,0.4673081471280318,0.9249546270841592,0.46446715231559454,0.5972500010329908,0.26162761482454844},
        breezeSquaredDistance=112.91827275873396,
        sqDist=112.91827275873396
      }
    }
    
    for _, params in ipairs(testData) do
      local sparseVector1 = Vectors.sparse(params.m, params.indices1, params.values1)
      local sparseVector2 = Vectors.sparse(params.m, params.indices2, params.values2)
      
      local denseVector1 = Vectors.dense(sparseVector1:toArray())
      local denseVector2 = Vectors.dense(sparseVector2:toArray())
      
      -- SparseVector vs. SparseVector
      assert.equal_relTol(params.breezeSquaredDistance, Vectors.sqdist(sparseVector1, sparseVector2), 1e-8)
      
      -- DenseVector  vs. SparseVector
      assert.equal_relTol(params.breezeSquaredDistance, Vectors.sqdist(denseVector1, sparseVector2), 1e-8)
      
      -- DenseVector  vs. DenseVector
      assert.equal_relTol(params.breezeSquaredDistance, Vectors.sqdist(sparseVector1, denseVector2), 1e-8)
    end
  end)

  it('foreachActive', function()
    local dv = Vectors.dense(0.0, 1.2, 3.1, 0.0)
    local sv = Vectors.sparse(4, {{1,1.2}, {2,3.1}, {3,0.0}})

    local dvMap = {}
    dv:foreachActive(function(index,value)
      dvMap[index+1] = value
    end)
    assert.equal(4, moses.size(dvMap))
    assert.equal(0.0, dvMap[1])
    assert.equal(1.2, dvMap[2])
    assert.equal(3.1, dvMap[3])
    assert.equal(0.0, dvMap[4])

    local svMap = {}
    sv:foreachActive(function(index,value)
      svMap[index] = value
    end)
    assert.equal(3, #svMap)
    assert.equal(1.2, svMap[1])
    assert.equal(3.1, svMap[2])
    assert.equal(0.0, svMap[3])
  end)

  it('vector p-norm', function()
    local dv = Vectors.dense(0.0, -1.2, 3.1, 0.0, -4.5, 1.9)
    local sv = Vectors.sparse(6, {{1, -1.2}, {2, 3.1}, {3, 0.0}, {4, -4.5}, {5, 1.9}})

    local expected = moses.reduce(dv:toArray(), function(a,v)
      return a + math.abs(v)
    end, 0.0)
    local actual = Vectors.norm(dv, 1.0)
    assert.equal_relTol(expected, actual, 1e-8)
      
    expected = moses.reduce(sv:toArray(), function(a,v)
      return a + math.abs(v)
    end, 0.0)
    actual = Vectors.norm(sv, 1.0)
    assert.equal_relTol(expected, actual, 1e-8)

    expected = math.sqrt(moses.reduce(dv:toArray(), function(a,v)
      return a + v * v
    end, 0.0))
    actual = Vectors.norm(dv, 2.0)
    assert.equal_relTol(expected, actual, 1e-8)

    expected = math.sqrt(moses.reduce(sv:toArray(), function(a,v)
      return a + v * v
    end, 0.0))
    actual = Vectors.norm(sv, 2.0)
    assert.equal_relTol(expected, actual, 1e-8)

    expected = moses.reduce(dv:toArray(), function(a,v)
      return math.max(a, math.abs(v))
    end, 0.0)
    actual = Vectors.norm(dv, math.huge)
    assert.equal_relTol(expected, actual, 1e-8)

    expected = moses.reduce(sv:toArray(), function(a,v)
      return math.max(a, math.abs(v))
    end, 0.0)
    actual = Vectors.norm(sv, math.huge)
    assert.equal_relTol(expected, actual, 1e-8)

    expected = math.pow(moses.reduce(dv:toArray(), function(a,v)
      return a + math.pow(math.abs(v), 3.7)
    end, 0.0), 1.0 / 3.7)
    actual = Vectors.norm(dv, 3.7)
    assert.equal_relTol(expected, actual, 1e-8)

    expected = math.pow(moses.reduce(sv:toArray(), function(a,v)
      return a + math.pow(math.abs(v), 3.7)
    end, 0.0), 1.0 / 3.7)
    actual = Vectors.norm(sv, 3.7)
    assert.equal_relTol(expected, actual, 1e-8)
  end)

  it('Vector numActive and numNonzeros', function()
    local dv = Vectors.dense(0.0, 2.0, 3.0, 0.0)
    assert.equal(4, dv:numActives())
    assert.equal(2, dv:numNonzeros())

    local sv = Vectors.sparse(4, {0, 1, 2}, {0.0, 2.0, 3.0})
    assert.equal(3, sv:numActives())
    assert.equal(2, sv:numNonzeros())
  end)

  it('Vector toSparse and toDense', function()
    local dv0 = Vectors.dense(0.0, 2.0, 3.0, 0.0)
    assert.same(dv0, dv0:toDense())
    local dv0s = dv0:toSparse()
    assert.equal(2, dv0s:numActives())
    
    -- This next compare doesn't work, because Lua < 5.3 automatically treats two tables
    -- as unequal if they have different metamethod tables. A search for a different
    -- class library might be necessary in order to try and achieve SparseVector and
    -- DenseVector having the same metatable, and therefore becoming comparable with __eq.
    --assert.equal(dv0, dv0s)
    
    -- here's a substitute test, for now
    assert.same(dv0:toArray(), dv0s:toArray())

    local sv0 = Vectors.sparse(4, {0,1,2}, {0.0,2.0,3.0})
    --assert.equal(sv0, sv0:toDense())
    assert.same(sv0:toArray(), sv0:toDense():toArray())
    
    local sv0s = sv0:toSparse()
    assert.equal(2, sv0s:numActives())
    --assert.same(sv0, sv0s)
    assert.same(sv0:toArray(), sv0s:toArray())
  end)

--  it('Vector.compressed', function()
--    val dv0 = Vectors.dense(1.0, 2.0, 3.0, 0.0)
--    val dv0c = dv0.compressed.asInstanceOf[DenseVector]
--    assert(dv0c === dv0)
--
--    val dv1 = Vectors.dense(0.0, 2.0, 0.0, 0.0)
--    val dv1c = dv1.compressed.asInstanceOf[SparseVector]
--    assert(dv1 === dv1c)
--    assert(dv1c:numActives() === 1)
--
--    val sv0 = Vectors.sparse(4, Array(1, 2), Array(2.0, 0.0))
--    val sv0c = sv0.compressed.asInstanceOf[SparseVector]
--    assert(sv0 === sv0c)
--    assert(sv0c:numActives() === 1)
--
--    val sv1 = Vectors.sparse(4, Array(0, 1, 2), Array(1.0, 2.0, 3.0))
--    val sv1c = sv1.compressed.asInstanceOf[DenseVector]
--    assert(sv1 === sv1c)
--  end)

--  it('SparseVector.slice', function()
--    val v = new SparseVector(5, Array(1, 2, 4), Array(1.1, 2.2, 4.4))
--    assert(v.slice(Array(0, 2)) === new SparseVector(2, Array(1), Array(2.2)))
--    assert(v.slice(Array(2, 0)) === new SparseVector(2, Array(0), Array(2.2)))
--    assert(v.slice(Array(2, 0, 3, 4)) === new SparseVector(4, Array(0, 3), Array(2.2, 4.4)))
--  end)

--  it('toJson/fromJson', function()
--    val sv0 = Vectors.sparse(0, Array.empty, Array.empty)
--    val sv1 = Vectors.sparse(1, Array.empty, Array.empty)
--    val sv2 = Vectors.sparse(2, Array(1), Array(2.0))
--    val dv0 = Vectors.dense(Array.empty[Double])
--    val dv1 = Vectors.dense(1.0)
--    val dv2 = Vectors.dense(0.0, 2.0)
--    for (v <- Seq(sv0, sv1, sv2, dv0, dv1, dv2)) {
--      val json = v.toJson
--      parseJson(json) // `json` should be a valid JSON string
--      val u = Vectors.fromJson(json)
--      assert(u.getClass === v.getClass, "toJson/fromJson should preserve vector types.")
--      assert(u === v, "toJson/fromJson should preserve vector values.")
--    }
--  end)

--  it('conversions between new local linalg and mllib linalg', function()
--    val dv: DenseVector = new DenseVector(Array(1.0, 2.0, 3.5))
--    val sv: SparseVector = new SparseVector(5, Array(1, 2, 4), Array(1.1, 2.2, 4.4))
--    val sv0: Vector = sv.asInstanceOf[Vector]
--    val dv0: Vector = dv.asInstanceOf[Vector]
--
--    val newSV: newlinalg.SparseVector = sv.asML
--    val newDV: newlinalg.DenseVector = dv.asML
--    val newSV0: newlinalg.Vector = sv0.asML
--    val newDV0: newlinalg.Vector = dv0.asML
--    assert(newSV0.isInstanceOf[newlinalg.SparseVector])
--    assert(newDV0.isInstanceOf[newlinalg.DenseVector])
--    assert(sv.toArray === newSV.toArray)
--    assert(dv.toArray === newDV.toArray)
--    assert(sv0.toArray === newSV0.toArray)
--    assert(dv0.toArray === newDV0.toArray)
--
--    val oldSV: SparseVector = SparseVector.fromML(newSV)
--    val oldDV: DenseVector = DenseVector.fromML(newDV)
--    val oldSV0: Vector = Vectors.fromML(newSV0)
--    val oldDV0: Vector = Vectors.fromML(newDV0)
--    assert(oldSV0.isInstanceOf[SparseVector])
--    assert(oldDV0.isInstanceOf[DenseVector])
--    assert(oldSV.toArray === newSV.toArray)
--    assert(oldDV.toArray === newDV.toArray)
--    assert(oldSV0.toArray === newSV0.toArray)
--    assert(oldDV0.toArray === newDV0.toArray)
--  end)

--  it('implicit conversions between new local linalg and mllib linalg', function()
--
--    def mllibVectorToArray(v: Vector): Array[Double] = v.toArray
--
--    def mllibDenseVectorToArray(v: DenseVector): Array[Double] = v.toArray
--
--    def mllibSparseVectorToArray(v: SparseVector): Array[Double] = v.toArray
--
--    def mlVectorToArray(v: newlinalg.Vector): Array[Double] = v.toArray
--
--    def mlDenseVectorToArray(v: newlinalg.DenseVector): Array[Double] = v.toArray
--
--    def mlSparseVectorToArray(v: newlinalg.SparseVector): Array[Double] = v.toArray
--
--    val dv: DenseVector = new DenseVector(Array(1.0, 2.0, 3.5))
--    val sv: SparseVector = new SparseVector(5, Array(1, 2, 4), Array(1.1, 2.2, 4.4))
--    val sv0: Vector = sv.asInstanceOf[Vector]
--    val dv0: Vector = dv.asInstanceOf[Vector]
--
--    val newSV: newlinalg.SparseVector = sv.asML
--    val newDV: newlinalg.DenseVector = dv.asML
--    val newSV0: newlinalg.Vector = sv0.asML
--    val newDV0: newlinalg.Vector = dv0.asML
--
--    import org.apache.spark.mllib.linalg.VectorImplicits._
--
--    assert(mllibVectorToArray(dv0) === mllibVectorToArray(newDV0))
--    assert(mllibVectorToArray(sv0) === mllibVectorToArray(newSV0))
--
--    assert(mllibDenseVectorToArray(dv) === mllibDenseVectorToArray(newDV))
--    assert(mllibSparseVectorToArray(sv) === mllibSparseVectorToArray(newSV))
--
--    assert(mlVectorToArray(dv0) === mlVectorToArray(newDV0))
--    assert(mlVectorToArray(sv0) === mlVectorToArray(newSV0))
--
--    assert(mlDenseVectorToArray(dv) === mlDenseVectorToArray(newDV))
--    assert(mlSparseVectorToArray(sv) === mlSparseVectorToArray(newSV))
--  end)
  
end)
